# Exports

This plugin automatically generates and updates the `exports` field in your package.json file after each build.

Bunup handles mapping all entry points to their corresponding output files, including ESM/CJS formats and type declarations. The exports field stays perfectly in sync with your build configuration always - no manual updates needed when you make any change to config.

## Usage

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: 'src/index.ts',
	plugins: [exports()],
});
```

When using the exports plugin, your package.json will be automatically updated with the correct exports field each time you build. For example:

```json [package.json]
{
	"name": "my-package",
	"version": "1.0.0",
	"type": "module",
	"files": [ // [!code ++]
		"dist" // [!code ++]
	], // [!code ++]
	"module": "./dist/index.js", // [!code ++]
	"main": "./dist/index.cjs", // [!code ++]
	"types": "./dist/index.d.ts", // [!code ++]
	"exports": { // [!code ++]
		".": { // [!code ++]
			"import": { // [!code ++]
				"types": "./dist/index.d.ts", // [!code ++]
				"default": "./dist/index.js" // [!code ++]
			}, // [!code ++]
			"require": { // [!code ++]
				"types": "./dist/index.d.cts", // [!code ++]
				"default": "./dist/index.cjs" // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
}
```

## Options

### `customExports`

The `customExports` option allows you to specify additional export fields that will be preserved alongside the automatically generated exports. This is useful when you need custom export conditions or paths that aren't automatically generated by the build process.

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: 'src/index.ts',
	plugins: [
		exports({
			customExports: (ctx) => ({
				'./package.json': './package.json',
			})
		})
	],
});
```

### `exclude`

The `exclude` option allows you to prevent specific entry points from being included in the exports field. You can provide either an array of glob patterns or exact entry point names, or a function that returns such an array.

**Note:** CLI files are excluded by default using these patterns:
- `**/cli.{js,mjs,cjs,ts}`
- `**/cli/index.{js,mjs,cjs,ts}`
- `cli.{js,mjs,cjs,ts}`
- `cli/index.{js,mjs,cjs,ts}`
- `src/cli.{js,mjs,cjs,ts}`
- `src/cli/index.{js,mjs,cjs,ts}`

Any additional patterns you provide will be merged with these defaults.

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: ['src/index.ts', 'src/cli.ts', 'src/plugins.ts'],
	plugins: [
		exports({
			exclude: ['src/cli.ts']
		})
	],
});
```

You can also use glob patterns:

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: ['src/index.ts', 'src/cli/*.ts', 'src/plugins.ts'],
	plugins: [
		exports({
			exclude: ['src/cli/*']
		})
	],
});
```

For more dynamic control, you can use a function:

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: ['src/index.ts', 'src/cli.ts', 'src/plugins.ts'],
	plugins: [
		exports({
			exclude: (ctx) => {
				// Access build context information
				const { options, output, meta } = ctx;
				return ['src/cli.ts'];
			}
		})
	],
});
```

### `excludeCss`

When you use CSS files and import them in your JavaScript files, Bun will bundle the CSS and include it in the build output. As a result, these CSS files will be automatically added to the exports field with appropriate export keys. 

The `excludeCss` option allows you to prevent CSS files from being included in the exports field if you prefer to handle CSS distribution manually or don't want to expose CSS files as part of your package's public API.

```ts [bunup.config.ts]
import { defineConfig } from 'bunup';
import { exports } from 'bunup/plugins';

export default defineConfig({
	entry: 'src/index.ts',
	plugins: [
		exports({
			excludeCss: true
		})
	],
});
```
